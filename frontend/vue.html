<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue | 进阶</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/myBlog/cc.png">
    <meta name="description" content="学习笔记">
    
    <link rel="preload" href="/myBlog/assets/css/0.styles.4d5c5372.css" as="style"><link rel="preload" href="/myBlog/assets/js/app.940a19a6.js" as="script"><link rel="preload" href="/myBlog/assets/js/3.92f17e55.js" as="script"><link rel="preload" href="/myBlog/assets/js/1.fb090512.js" as="script"><link rel="preload" href="/myBlog/assets/js/10.3cd559f0.js" as="script"><link rel="prefetch" href="/myBlog/assets/js/11.dba209a7.js"><link rel="prefetch" href="/myBlog/assets/js/12.e667cf24.js"><link rel="prefetch" href="/myBlog/assets/js/13.dcd5e38c.js"><link rel="prefetch" href="/myBlog/assets/js/14.a0972b59.js"><link rel="prefetch" href="/myBlog/assets/js/15.6269d436.js"><link rel="prefetch" href="/myBlog/assets/js/16.be6459c1.js"><link rel="prefetch" href="/myBlog/assets/js/17.80243272.js"><link rel="prefetch" href="/myBlog/assets/js/18.a9e42de3.js"><link rel="prefetch" href="/myBlog/assets/js/19.6e91205d.js"><link rel="prefetch" href="/myBlog/assets/js/20.8f018a53.js"><link rel="prefetch" href="/myBlog/assets/js/21.411c8fec.js"><link rel="prefetch" href="/myBlog/assets/js/22.06836dde.js"><link rel="prefetch" href="/myBlog/assets/js/23.a850ac2d.js"><link rel="prefetch" href="/myBlog/assets/js/24.a6ab77b9.js"><link rel="prefetch" href="/myBlog/assets/js/25.e51c3db5.js"><link rel="prefetch" href="/myBlog/assets/js/26.54424bc6.js"><link rel="prefetch" href="/myBlog/assets/js/27.c0cd6a92.js"><link rel="prefetch" href="/myBlog/assets/js/28.ed41b7c0.js"><link rel="prefetch" href="/myBlog/assets/js/29.a90faddb.js"><link rel="prefetch" href="/myBlog/assets/js/30.93959302.js"><link rel="prefetch" href="/myBlog/assets/js/31.2d69b3bf.js"><link rel="prefetch" href="/myBlog/assets/js/32.8d591d1b.js"><link rel="prefetch" href="/myBlog/assets/js/33.0df8b39c.js"><link rel="prefetch" href="/myBlog/assets/js/34.e9bf4ee2.js"><link rel="prefetch" href="/myBlog/assets/js/35.d9cd3a1e.js"><link rel="prefetch" href="/myBlog/assets/js/36.be1dd74d.js"><link rel="prefetch" href="/myBlog/assets/js/37.dc3b4787.js"><link rel="prefetch" href="/myBlog/assets/js/38.2f517de4.js"><link rel="prefetch" href="/myBlog/assets/js/39.bcc498a9.js"><link rel="prefetch" href="/myBlog/assets/js/4.20d827d9.js"><link rel="prefetch" href="/myBlog/assets/js/40.a2675ec2.js"><link rel="prefetch" href="/myBlog/assets/js/41.49a77ffa.js"><link rel="prefetch" href="/myBlog/assets/js/42.6b5bb905.js"><link rel="prefetch" href="/myBlog/assets/js/43.514eac2c.js"><link rel="prefetch" href="/myBlog/assets/js/44.aeeb8da3.js"><link rel="prefetch" href="/myBlog/assets/js/45.0b6b04ec.js"><link rel="prefetch" href="/myBlog/assets/js/46.f916029d.js"><link rel="prefetch" href="/myBlog/assets/js/47.65530fb7.js"><link rel="prefetch" href="/myBlog/assets/js/48.047367f4.js"><link rel="prefetch" href="/myBlog/assets/js/49.2cf38cf2.js"><link rel="prefetch" href="/myBlog/assets/js/5.3e1da93b.js"><link rel="prefetch" href="/myBlog/assets/js/50.6d32f4c2.js"><link rel="prefetch" href="/myBlog/assets/js/51.93d82dd6.js"><link rel="prefetch" href="/myBlog/assets/js/52.6d48b8e6.js"><link rel="prefetch" href="/myBlog/assets/js/53.2550e734.js"><link rel="prefetch" href="/myBlog/assets/js/54.66c1cfec.js"><link rel="prefetch" href="/myBlog/assets/js/55.46a3f7ab.js"><link rel="prefetch" href="/myBlog/assets/js/56.b557ca7c.js"><link rel="prefetch" href="/myBlog/assets/js/57.ebb555a0.js"><link rel="prefetch" href="/myBlog/assets/js/58.25dec79d.js"><link rel="prefetch" href="/myBlog/assets/js/59.bf876983.js"><link rel="prefetch" href="/myBlog/assets/js/6.be50992c.js"><link rel="prefetch" href="/myBlog/assets/js/60.6200a9fb.js"><link rel="prefetch" href="/myBlog/assets/js/61.ce22748f.js"><link rel="prefetch" href="/myBlog/assets/js/62.103b56df.js"><link rel="prefetch" href="/myBlog/assets/js/63.13ee4c34.js"><link rel="prefetch" href="/myBlog/assets/js/64.d30d815b.js"><link rel="prefetch" href="/myBlog/assets/js/65.bf68d759.js"><link rel="prefetch" href="/myBlog/assets/js/66.737eaca7.js"><link rel="prefetch" href="/myBlog/assets/js/67.bcf6e7e2.js"><link rel="prefetch" href="/myBlog/assets/js/68.3bf6fefd.js"><link rel="prefetch" href="/myBlog/assets/js/69.59977576.js"><link rel="prefetch" href="/myBlog/assets/js/7.1874a01a.js"><link rel="prefetch" href="/myBlog/assets/js/70.33584d1e.js"><link rel="prefetch" href="/myBlog/assets/js/71.a61a1e77.js"><link rel="prefetch" href="/myBlog/assets/js/8.1b7710be.js"><link rel="prefetch" href="/myBlog/assets/js/9.3f2d5568.js">
    <link rel="stylesheet" href="/myBlog/assets/css/0.styles.4d5c5372.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-9f1e2f90><div data-v-9f1e2f90><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-9f1e2f90 data-v-9f1e2f90><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-58d5ab76 data-v-9f1e2f90 data-v-9f1e2f90><h3 class="title" style="display:none;" data-v-58d5ab76 data-v-58d5ab76>进阶</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-58d5ab76 data-v-58d5ab76><input type="password" value="" data-v-58d5ab76> <span data-v-58d5ab76>Konck! Knock!</span> <button data-v-58d5ab76>OK</button></label> <div class="footer" style="display:none;" data-v-58d5ab76 data-v-58d5ab76><span data-v-58d5ab76><i class="iconfont reco-theme" data-v-58d5ab76></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-58d5ab76>vuePress-theme-reco</a></span> <span data-v-58d5ab76><i class="iconfont reco-copyright" data-v-58d5ab76></i> <a data-v-58d5ab76><span data-v-58d5ab76>R-Z</span>
            
          <!---->
          2023
        </a></span></div></div> <div class="hide" data-v-9f1e2f90><header class="navbar" data-v-9f1e2f90><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/myBlog/" class="home-link router-link-active"><img src="/myBlog/cc.png" alt="进阶" class="logo"> <span class="site-name">进阶</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/myBlog/" class="nav-link"><i class="iconfont undefined"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myBlog/categories/布局/" class="nav-link"><i class="iconfont undefined"></i>
  布局
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/frontEnd/" class="nav-link"><i class="iconfont undefined"></i>
  frontEnd
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/网络/" class="nav-link"><i class="iconfont undefined"></i>
  网络
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/Tools/" class="nav-link"><i class="iconfont undefined"></i>
  Tools
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/tools/" class="nav-link"><i class="iconfont undefined"></i>
  tools
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/工具/" class="nav-link"><i class="iconfont undefined"></i>
  工具
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/面试/" class="nav-link"><i class="iconfont undefined"></i>
  面试
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/智能/" class="nav-link"><i class="iconfont undefined"></i>
  智能
</a></li></ul></div></div><div class="nav-item"><a href="/myBlog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/myBlog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/myBlog/frontend/" class="nav-link router-link-active"><i class="iconfont undefined"></i>
  前端知识
</a></div><div class="nav-item"><a href="/myBlog/algorithm/" class="nav-link"><i class="iconfont undefined"></i>
  算法
</a></div><div class="nav-item"><a href="/myBlog/project/" class="nav-link"><i class="iconfont undefined"></i>
  项目
</a></div><div class="nav-item"><a href="/myBlog/notes/" class="nav-link"><i class="iconfont undefined"></i>
  笔记
</a></div><div class="nav-item"><a href="/myBlog/blog/" class="nav-link"><i class="iconfont undefined"></i>
  文章
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Languages
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myBlog/language/chinese.html" class="nav-link"><i class="iconfont undefined"></i>
  Chinese
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/language/English.html" class="nav-link"><i class="iconfont undefined"></i>
  English
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-9f1e2f90></div> <aside class="sidebar" data-v-9f1e2f90><div class="personal-info-wrapper" data-v-3eba7259 data-v-9f1e2f90><!----> <h3 class="name" data-v-3eba7259>
    R-Z
  </h3> <div class="num" data-v-3eba7259><div data-v-3eba7259><h3 data-v-3eba7259>31</h3> <h6 data-v-3eba7259>Article</h6></div> <div data-v-3eba7259><h3 data-v-3eba7259>17</h3> <h6 data-v-3eba7259>Tag</h6></div></div> <hr data-v-3eba7259></div> <nav class="nav-links"><div class="nav-item"><a href="/myBlog/" class="nav-link"><i class="iconfont undefined"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myBlog/categories/布局/" class="nav-link"><i class="iconfont undefined"></i>
  布局
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/frontEnd/" class="nav-link"><i class="iconfont undefined"></i>
  frontEnd
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/网络/" class="nav-link"><i class="iconfont undefined"></i>
  网络
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/Tools/" class="nav-link"><i class="iconfont undefined"></i>
  Tools
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/tools/" class="nav-link"><i class="iconfont undefined"></i>
  tools
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/工具/" class="nav-link"><i class="iconfont undefined"></i>
  工具
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/面试/" class="nav-link"><i class="iconfont undefined"></i>
  面试
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/智能/" class="nav-link"><i class="iconfont undefined"></i>
  智能
</a></li></ul></div></div><div class="nav-item"><a href="/myBlog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/myBlog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/myBlog/frontend/" class="nav-link router-link-active"><i class="iconfont undefined"></i>
  前端知识
</a></div><div class="nav-item"><a href="/myBlog/algorithm/" class="nav-link"><i class="iconfont undefined"></i>
  算法
</a></div><div class="nav-item"><a href="/myBlog/project/" class="nav-link"><i class="iconfont undefined"></i>
  项目
</a></div><div class="nav-item"><a href="/myBlog/notes/" class="nav-link"><i class="iconfont undefined"></i>
  笔记
</a></div><div class="nav-item"><a href="/myBlog/blog/" class="nav-link"><i class="iconfont undefined"></i>
  文章
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Languages
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myBlog/language/chinese.html" class="nav-link"><i class="iconfont undefined"></i>
  Chinese
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/language/English.html" class="nav-link"><i class="iconfont undefined"></i>
  English
</a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><a href="/myBlog/frontend/" aria-current="page" class="sidebar-link">JS</a></li><li><a href="/myBlog/frontend/es6.html" class="sidebar-link">ES6</a></li><li><a href="/myBlog/frontend/typescript.html" class="sidebar-link">TS</a></li><li><a href="/myBlog/frontend/html.html" class="sidebar-link">HTML</a></li><li><a href="/myBlog/frontend/css.html" class="sidebar-link">CSS</a></li><li><a href="/myBlog/frontend/http.html" class="sidebar-link">HTTP</a></li><li><a href="/myBlog/frontend/browser.html" class="sidebar-link">浏览器</a></li><li><a href="/myBlog/frontend/webpack.html" class="sidebar-link">Webpack</a></li><li><a href="/myBlog/frontend/vue.html" aria-current="page" class="active sidebar-link">Vue</a></li><li><a href="/myBlog/frontend/vue3.html" class="sidebar-link">Vue3</a></li><li><a href="/myBlog/frontend/react.html" class="sidebar-link">React</a></li><li><a href="/myBlog/frontend/mobile.html" class="sidebar-link">移动 Web 开发</a></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-58d5ab76 data-v-9f1e2f90><h3 class="title" style="display:none;" data-v-58d5ab76 data-v-58d5ab76></h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-58d5ab76 data-v-58d5ab76><input type="password" value="" data-v-58d5ab76> <span data-v-58d5ab76>Konck! Knock!</span> <button data-v-58d5ab76>OK</button></label> <div class="footer" style="display:none;" data-v-58d5ab76 data-v-58d5ab76><span data-v-58d5ab76><i class="iconfont reco-theme" data-v-58d5ab76></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-58d5ab76>vuePress-theme-reco</a></span> <span data-v-58d5ab76><i class="iconfont reco-copyright" data-v-58d5ab76></i> <a data-v-58d5ab76><span data-v-58d5ab76>R-Z</span>
            
          <!---->
          2023
        </a></span></div></div> <div data-v-9f1e2f90><main class="page"><div class="page-title" style="display:none;"><h1 class="title">Vue</h1> <div data-v-42458482><i class="iconfont reco-account" data-v-42458482><span data-v-42458482>R-Z</span></i> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default" style="display:none;"><h1 id="vue"><a href="#vue" class="header-anchor">#</a> Vue</h1> <h2 id="vue-基本使用"><a href="#vue-基本使用" class="header-anchor">#</a> Vue 基本使用</h2> <h3 id="vue-组成"><a href="#vue-组成" class="header-anchor">#</a> Vue 组成</h3> <p>一个 Vue 实例一般由</p> <ul><li><code>&lt;template&gt;&lt;/template&gt;</code>视图模板</li> <li><code>&lt;script&gt;&lt;/script&gt;</code>中的 data 数据和相关方法</li> <li><code>&lt;style&gt;&lt;/style&gt;</code>中的页面样式组成。</li></ul> <p><strong>优点</strong></p> <ul><li>轻量、快速，数据双向绑定，数据驱动视图，操作简单</li> <li>组件化，组件可封装并复用</li> <li>使用虚拟 DOM，优化性能表现</li></ul> <p><strong>Vue 指令</strong></p> <ul><li>v-bind：简写为<code>:</code>，用于动态绑定标签属性</li> <li>v-on：简写为<code>@</code>，用于绑定事件，可以监听多个方法<br>
如：<code>&lt;input type=&quot;text&quot; v-on=&quot;{input: onInput, blur: onBlur}&quot;/&gt;</code></li></ul> <p><strong>双向数据绑定：v-model</strong></p> <ul><li>用于 input、select、textarea 等表单元素中，绑定表单数据<br>
如：<code>&lt;input v-model=&quot;变量&quot;/&gt;</code>，表单值和变量值会同步变化</li></ul> <p><strong>v-if 和 v-show 的区别</strong></p> <ul><li>v-if 切换会创建和销毁标签，v-show 只是切换标签的 display 属性</li> <li>v-if 是在显示的时候才进行渲染，v-show 只是简单的基于 css 切换</li> <li>v-if 有更高的切换消耗，v-show 有更高的初始渲染消耗</li> <li>运行时条件一般不改变使用 v-if，频繁切换使用 v-show</li></ul> <p><strong>vue 常用修饰符</strong></p> <ul><li>以<code>.名称</code>的形式添加到 vue 指令后，实现相应的功能</li> <li><code>v-model.lazy</code>：添加 lazy 后则数据与 change 事件同步，而不是每次 input 事件，相当于防抖</li> <li><code>v-model.number</code>：将输入的值转换为数值类型，不能转换的则不可输入</li> <li><code>v-model.trim</code>：自动过滤用户输入前后空格</li> <li><code>v-on:click.stop</code>：阻止单击事件继续传播</li> <li><code>@click.stop.prevent</code>：修饰符可连接，阻止传播+阻止默认事件（注意顺序，会有不同的影响）</li></ul> <p><strong>为什么组件中的 data 是一个函数？</strong></p> <ul><li>复用组件时，对象为引用类型，数据对象会共享一个 data 对象</li> <li>则如果一个组件修改了 data 中数据会影响其他组件数据</li> <li>使用函数每次都会返回一个新的对象，引用地址不同</li></ul> <h3 id="computed-和-watch"><a href="#computed-和-watch" class="header-anchor">#</a> computed 和 watch</h3> <p><strong>计算属性</strong></p> <ul><li>用于变量存在复杂逻辑时的计算，依赖其他属性算出来得到的值（也可以是数组和对象等）</li> <li>computed 有缓存，只有其依赖的属性改变时，才会重新计算</li> <li>不支持异步，其中的异步操作无效</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  
  el<span class="token operator">:</span> <span class="token string">'#demo'</span><span class="token punctuation">,</span>  
  data<span class="token operator">:</span> <span class="token punctuation">{</span>  
    firstName<span class="token operator">:</span> <span class="token string">'Foo'</span><span class="token punctuation">,</span>  
    lastName<span class="token operator">:</span> <span class="token string">'Bar'</span>  
  <span class="token punctuation">}</span><span class="token punctuation">,</span>  
  computed<span class="token operator">:</span> <span class="token punctuation">{</span>  
      <span class="token comment">// 计算属性的getter  </span>
      <span class="token comment">// 最终就得到一个fullName值，这个值可以直接使用，相当于data里有一个fullName，后面无括号()  </span>
      <span class="token function-variable function">fullName</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>firstName <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lastName  
    <span class="token punctuation">}</span>  
  <span class="token punctuation">}</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  
</code></pre></div><p><strong>侦听器</strong></p> <ul><li>用来侦听一个特定的值，当该值变化时执行特定的函数</li> <li>监听的值变化时，都会执行回调</li> <li>支持异步，接收两个参数，一个 newVal，一个 oldVal</li> <li>watch 监听引用类型，拿不到 oldVal，添加 deep:true 后可以深度监听</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  
  el<span class="token operator">:</span> <span class="token string">'#demo'</span><span class="token punctuation">,</span>  
  data<span class="token operator">:</span> <span class="token punctuation">{</span>  
    firstName<span class="token operator">:</span> <span class="token string">'Foo'</span><span class="token punctuation">,</span>  
    lastName<span class="token operator">:</span> <span class="token string">'Bar'</span><span class="token punctuation">,</span>  
    fullName<span class="token operator">:</span> <span class="token string">'Foo Bar'</span>  
  <span class="token punctuation">}</span><span class="token punctuation">,</span>  
  watch<span class="token operator">:</span> <span class="token punctuation">{</span>  
      <span class="token comment">// watch是执行操作，computed是得到一个值  </span>
      <span class="token comment">// firstName和lastName即为被侦听的对象，val也就是指代其值  </span>
      <span class="token function-variable function">firstName</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>fullName <span class="token operator">=</span> val <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lastName  
      <span class="token punctuation">}</span><span class="token punctuation">,</span>  
      <span class="token function-variable function">lastName</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>fullName <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>firstName <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> val  
      <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  
</code></pre></div><h3 id="生命周期"><a href="#生命周期" class="header-anchor">#</a> 生命周期</h3> <ul><li>创建阶段：<strong>beforeCreate</strong> 中 vue 实例中的挂载元素 el 和数据对象 data 都未初始化，为 undefined；<strong>created</strong> 中 data 初始化，可以获取到 data、coomputed、watch。而 el 还未初始化。</li> <li>载入阶段：<strong>beforeMount</strong> 中，el 和 data 都已初始化，但此时还是虚拟 DOM 节点；<strong>mounted</strong> 中 DOM 和 data 数据渲染完成。</li> <li>更新阶段：data 变化时，会依次触发 <strong>beforeUpdate</strong> 和 <strong>updated</strong> 方法。</li> <li>销毁阶段：<strong>beforeDestroy</strong> 中还可以获取到数据和事件；执行 <strong>destroyed</strong> 后，vue 已经解除了事件监听和 DOM 绑定，只是 DOM 结构还存在。<br> <img alt="cycle" src="https://v2.cn.vuejs.org/images/lifecycle.png" style="zoom:50%;"></li></ul> <p><strong>父子组件生命周期</strong></p> <ul><li>创建阶段首先创建父组件，再创建子组件</li> <li>渲染时首先渲染子组件，再渲染父组件</li></ul> <h3 id="class-和-style"><a href="#class-和-style" class="header-anchor">#</a> class 和 style</h3> <ul><li>使用动态属性绑定：<code>:class</code>和<code>:style</code></li> <li>使用驼峰式写法 + 字符串值</li></ul> <h3 id="循环-列表-渲染"><a href="#循环-列表-渲染" class="header-anchor">#</a> 循环（列表）渲染</h3> <p>遍历数组：<br> <code>&lt;li v-for=&quot;(item, key) in listArr&quot; :key=&quot;item.id&gt;  &lt;/li&gt;&quot;</code><br>
遍历对象：<br> <code>v-for=&quot;(val, key, index) in listObj&quot; :key=&quot;key&quot;</code><br>
注意：v-if 和 v-for 不在一个标签内使用<br> <strong>v-for 中为什么使用 key？</strong></p> <ul><li>key 为 string 或 number 类型</li> <li>key 值唯一，用于 Vue 跟踪每个节点的身份，也可以按照 key 值渲染元素</li> <li>原理在于 diff 算法中，辨别新旧 Vnode</li> <li>不使用 key 则更新时需要将旧节点全部删除，再插入新节点</li> <li>使用 key 可以将相同的节点保留，移动位置排序，只需要创建不同的节点插入，更加快速高效</li></ul> <h3 id="事件"><a href="#事件" class="header-anchor">#</a> 事件</h3> <p>event 参数如何传递：</p> <ul><li>当函数中无其他参数时，event 可以默认传过去</li> <li>当函数中有其他参数时，使用 $event 传入事件参数</li> <li>注：event 是原生的，且被挂载到当前元素</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">&quot;add1()&quot;</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>  
<span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">&quot;add2(2, $event)&quot;</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>  

methods<span class="token operator">:</span><span class="token punctuation">{</span>  
    <span class="token function">add1</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">)</span>  
    <span class="token punctuation">}</span>  
    <span class="token function">add2</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  

</code></pre></div><h3 id="表单"><a href="#表单" class="header-anchor">#</a> 表单</h3> <ul><li>v-model</li> <li>常见表单项：textarea checkbox radio select</li> <li>修饰符 lazy number trim</li></ul> <h3 id="组件通讯"><a href="#组件通讯" class="header-anchor">#</a> 组件通讯</h3> <ul><li>props 和 $emit</li> <li>组件间通讯-自定义事件</li> <li>vuex</li></ul> <p><strong>父传子</strong></p> <ul><li>父组件声明一个属性表示要传递的数据</li> <li>子组件使用 props 接收父组件传递的数据</li> <li>可以通过点击事件或者计算属性进行赋值操作</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 父组件中  </span>
<span class="token operator">&lt;</span>Child myData <span class="token operator">=</span> <span class="token string">'传递的数据'</span><span class="token operator">/</span><span class="token operator">&gt;</span>  

<span class="token comment">// 子组件中  </span>
<span class="token comment">// 接收数据，然后就可以使用myData，就像是使用data中的数据一样  </span>
<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>  
    props<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'myData'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment">// 使用myData接收  </span>
    <span class="token comment">/* props:{       // 比较完整的写法，有默认值和类型，类型不正确时vue会警告  
        myData:{  
            default: &quot;&quot;,  
            type: String,  
        }  
    } */</span>  
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        <span class="token keyword">return</span><span class="token punctuation">{</span>  

        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  
</code></pre></div><p>动态传值：实时更新父组件的值，子组件动态更新，使用 Watch</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 子组件</span>
watch<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">myData</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// myData 即为父组件的值，val 参数为值</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>testData <span class="token operator">=</span> val<span class="token punctuation">;</span>   <span class="token comment">// 将父组件的值赋给子组件中的 testData</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>子传父</strong></p> <ul><li>父组件中给子组件绑定一个自定义的事件，子组件通过 $emit() 触发该事件并传值</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 父组件  </span>
<span class="token operator">&lt;</span>Child @myEvent <span class="token operator">=</span> <span class="token string">'process'</span><span class="token operator">/</span><span class="token operator">&gt;</span>   <span class="token comment">// 这里传参不用加括号了  </span>
methods<span class="token operator">:</span><span class="token punctuation">{</span>  
    <span class="token comment">// data即为子组件传过来的数据  </span>
    <span class="token function">process</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        <span class="token comment">// 事件处理  </span>
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  

<span class="token comment">// 子组件中，可以在某一方法中触发 $emit  </span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'myEvent'</span><span class="token punctuation">,</span> <span class="token string">'传递的数据'</span><span class="token punctuation">)</span>  
</code></pre></div><p><strong>兄弟组件通讯</strong></p> <ol><li>先子传父，再父传子</li> <li>使用中央总线通信 bus，创建自定义事件触发和接收</li></ol> <h2 id="vue-高级特性"><a href="#vue-高级特性" class="header-anchor">#</a> Vue 高级特性</h2> <ul><li>自定义 v-model</li> <li>$nextTick</li> <li>slot</li> <li>动态、异步组件</li> <li>keep-alive</li> <li>mixin</li></ul> <h3 id="自定义-v-model"><a href="#自定义-v-model" class="header-anchor">#</a> 自定义 v-model</h3> <p><img src="/myBlog/assets/img/v-model.3e3abf9c.png" alt="v-model"></p> <h3 id="nexttick"><a href="#nexttick" class="header-anchor">#</a> $nextTick</h3> <ul><li>Vue 响应式中，data 变化后 DOM 不是立即变化，而是异步渲染</li> <li>$nextTick 是执行延迟回调，会在 DOM 渲染之后被触发，所以修改数据之后使用它可以在回调中获取更新后的 DOM</li></ul> <p><strong>ref 用来获取 DOM 元素</strong><br>
先给标签设置一个 ref 值，再通过<code>this.$refs.domName</code>来获取，配合<code>$nextTick</code>来使用，如：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>ul ref<span class="token operator">=</span><span class="token string">'ul1'</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>  <span class="token comment">// 标签中添加ref   </span>

<span class="token keyword">const</span> ulElem <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>ul1   <span class="token comment">// 获取DOM元素（refs）  </span>

<span class="token comment">// 1. 异步渲染，$nextTick待DOM渲染完再回调  </span>
<span class="token comment">// 2. 页面渲染时会将data修改整合，多次data修改只会渲染一次  </span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  
    <span class="token keyword">const</span> ulElem <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>ul1  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  
</code></pre></div><h3 id="slot"><a href="#slot" class="header-anchor">#</a> slot</h3> <ul><li>可以看成组件的扩展，用于向组件中我们想要的位置添加一些内容</li></ul> <p><strong>slot 的理解</strong></p> <div class="language-html extra-class"><pre class="language-html"><code>1. 首先考虑父组件向子组件中传递数据  
<span class="token comment">&lt;!-- 父组件   --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Child</span> <span class="token attr-name">myData</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>数据<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>我想添加的内容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Child</span><span class="token punctuation">&gt;</span></span>  
<span class="token comment">&lt;!-- 注意：向子组件中传递的数据只有myData，默认包裹的所有内容都会被忽略   --&gt;</span>

2. 那么怎么向子组件中插入其他的数据，或者标签元素呢？答：子组件中使用slot  

<span class="token comment">&lt;!-- 子组件   --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span><span class="token punctuation">&gt;</span></span>我是一个 a 标签<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span>我是 slot 默认内容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>   // 注意这里的slot  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>  
3. 子组件中的 slot 会被完全替代为父组件中“我想添加的内容”  
<span class="token comment">&lt;!-- 如果父组件中不添加内容，则子组件显示slot的默认内容，也可以不设置   --&gt;</span>
<span class="token comment">&lt;!-- 另外，slot可以设置style属性   --&gt;</span>
</code></pre></div><p><strong>基本使用</strong><br>
很多时候，我们封装了一个子组件之后，在父组件使用的时候，想添加一些 DOM 元素，这个时候就可以使用 slot 插槽了，但是这些 DOM 是否显示以及在哪里显示，则是看子组件中 slot 组件的位置了。<br>
插槽从父组件获取值：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 父组件中   --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SlotDemo</span> <span class="token attr-name">:url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>website.url<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>  
    {{website.title}}    // 传入了父组件中的 title 变量  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SlotDemo</span><span class="token punctuation">&gt;</span></span>  

<span class="token comment">&lt;!-- 子组件中   --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">:href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span>   <span class="token comment">&lt;!-- 这里slot标签就被替换为了父组件中的titile变量 --&gt;</span> 
    <span class="token comment">&lt;!-- 默认内容，若父组件没设置内容，显示此内容 --&gt;</span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>  
export default{  
    props: ['url']  
    data(){  
        return {}  
    }  
}  
</code></pre></div><p><strong>作用域插槽</strong></p> <ul><li>父组件从子组件插槽中获取数据</li> <li>子组件将要传递的内容绑定到 slot 上，父组件中用 v-slot 定义一个值接收插槽的名字</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>SlotDemo <span class="token operator">:</span>url<span class="token operator">=</span><span class="token string">&quot;website.url&quot;</span><span class="token operator">&gt;</span>  
    <span class="token operator">&lt;</span>template v<span class="token operator">-</span>slot<span class="token operator">:</span><span class="token keyword">default</span><span class="token operator">=</span><span class="token string">&quot;slotProps&quot;</span><span class="token operator">&gt;</span>  <span class="token comment">// slotProps就代表了子组件中的插槽  </span>
        <span class="token punctuation">{</span><span class="token punctuation">{</span>slotProps<span class="token punctuation">.</span>userData<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span>  
    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>  
<span class="token operator">&lt;</span><span class="token operator">/</span>SlotDemo<span class="token operator">&gt;</span>  
<span class="token comment">// 注：default可省略，当提供的内容只有slot内容时，v-slot才可绑定在子组件上，省略template  </span>

<span class="token comment">// 子组件中  </span>
<span class="token operator">&lt;</span>a <span class="token operator">:</span>href<span class="token operator">=</span><span class="token string">&quot;url&quot;</span><span class="token operator">&gt;</span>  
    <span class="token operator">&lt;</span>slot <span class="token operator">:</span>userData<span class="token operator">=</span><span class="token string">&quot;user&quot;</span><span class="token operator">&gt;</span>  <span class="token comment">// 绑定要传递的数据  </span>
        默认内容  
    <span class="token operator">&lt;</span><span class="token operator">/</span>slot<span class="token operator">&gt;</span>  
<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>  
<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>  
    props<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span>  
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token punctuation">{</span>  
            user<span class="token operator">:</span><span class="token punctuation">{</span>  
                name<span class="token operator">:</span> <span class="token string">'z'</span><span class="token punctuation">,</span>  
                age<span class="token operator">:</span> <span class="token number">25</span>  
            <span class="token punctuation">}</span>  
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  
</code></pre></div><p><strong>具名插槽</strong></p> <ul><li>一个组件中需要多个插槽时，在 slot 中添加 name 属性</li> <li>父组件中使用 v-slot 绑定 name 属性，即可正确按顺序插入</li></ul> <h3 id="动态组件"><a href="#动态组件" class="header-anchor">#</a> 动态组件</h3> <ul><li>:is=&quot;comonentName&quot;</li> <li>根据数据，动态渲染组件，即要加载的组件类型不确定，如新闻流。</li> <li>如 v-for 遍历中，首先得到组件的类型数据，然后再得到其他数据渲染出来。</li></ul> <h3 id="异步组件"><a href="#异步组件" class="header-anchor">#</a> 异步组件</h3> <ul><li>异步加载组件，意思是什么时候用到，什么时候再加载组件</li> <li>主要用到 import() 函数，一般用于较大组件的加载</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 在coponents属性中引入属性时，用import()  </span>
components<span class="token operator">:</span><span class="token punctuation">{</span>  
    <span class="token function-variable function">FormDemo</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'路径'</span><span class="token punctuation">)</span>  <span class="token comment">// 采用这种import方式  </span>
<span class="token punctuation">}</span>  
</code></pre></div><h3 id="缓存组件-keep-alive"><a href="#缓存组件-keep-alive" class="header-anchor">#</a> 缓存组件: keep-alive</h3> <ul><li>频繁切换时，不需要重复渲染</li> <li>将需要缓存的组件使用<code>&lt;keey-alive&gt;&lt;component&gt;&lt;/component&gt;&lt;/keey-alive&gt;</code>包裹</li> <li>框架层级，Vue 控制 js 对象（跟 v-show 区别）</li></ul> <h3 id="mixin"><a href="#mixin" class="header-anchor">#</a> mixin</h3> <ul><li>多个组件有相同的逻辑，抽离出来</li> <li>Vue3 使用 Composition API 解决这些问题</li> <li>混合，用来存放公共数据和逻辑，然后引入到某个页面后会将数据和方法合并到当前页面</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 引入  </span>
<span class="token keyword">import</span> myMixin from <span class="token operator">...</span>  
<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>  
    mixins<span class="token operator">:</span> <span class="token punctuation">[</span>myMixin<span class="token punctuation">]</span>  
<span class="token punctuation">}</span>  
</code></pre></div><p>问题：</p> <ul><li>变量来源不明确，代码可读性差</li> <li>多个 mixin 可能会造成命名冲突</li> <li>mixin 和组件可能出现多对多关系，复杂度较高</li></ul> <h3 id="vuex"><a href="#vuex" class="header-anchor">#</a> Vuex</h3> <p>组成：</p> <ul><li>state：全部组件公共状态</li> <li>getters：相当于 store 的计算属性。使用 $store.getters.</li> <li>mutations：修改状态的方法。使用 $store.commit('', params)</li> <li>actions：异步操作。使用 $store.dispatch('')</li> <li>modules：store 分割得到的模块，每个模块都有自己的 state、getters 等。</li></ul> <p><img src="/myBlog/assets/img/vuex.d3188f6d.png" alt="vuex"></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  
    <span class="token comment">// 公共状态数据  </span>
    state<span class="token operator">:</span> <span class="token punctuation">{</span>  
        count<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>  
        todos<span class="token operator">:</span><span class="token punctuation">[</span>  
            <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> text<span class="token operator">:</span><span class="token string">'hi'</span><span class="token punctuation">,</span> done<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  
            <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> text<span class="token operator">:</span><span class="token string">'nihao'</span><span class="token punctuation">,</span> done<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span>  
        <span class="token punctuation">]</span>  
    <span class="token punctuation">}</span><span class="token punctuation">,</span>  
    <span class="token comment">// 根据依赖的state属性计算  </span>
    getters<span class="token operator">:</span><span class="token punctuation">{</span>  
        <span class="token function-variable function">doneTodos</span><span class="token operator">:</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>  
            <span class="token keyword">return</span> state<span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">todo</span> <span class="token operator">=&gt;</span> todo<span class="token punctuation">.</span>done<span class="token punctuation">)</span>  
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span><span class="token punctuation">,</span>  
    <span class="token comment">// 其中定义的方法可以用于修改state中数据  </span>
    mutations<span class="token operator">:</span><span class="token punctuation">{</span>  
        <span class="token function">increment</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
            <span class="token comment">// 变更状态  </span>
            state<span class="token punctuation">.</span>count<span class="token operator">++</span>  
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span><span class="token punctuation">,</span>  
    <span class="token comment">// 类似mutation，但mutation是直接触发方法，action提交的是mutation  </span>
    <span class="token comment">// action中可以包含异步操作，mutations中不行  </span>
    actions<span class="token operator">:</span> <span class="token punctuation">{</span>  
        <span class="token function">increment</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
            context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'increment'</span><span class="token punctuation">)</span>  
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  

<span class="token comment">// getters调用  </span>
store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>doneTodos   <span class="token comment">// 获取到doneTodos数据  </span>

<span class="token comment">// mutations触发  </span>
store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'increment'</span><span class="token punctuation">)</span>   <span class="token comment">// 触发了increment方法，count++  </span>

<span class="token comment">// actions触发  </span>
<span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'increment'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>  
</code></pre></div><p><strong>module</strong>：Vuex 允许将 Store 切分为不同的 module，提高代码可读性</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> moduleA <span class="token operator">=</span> <span class="token punctuation">{</span>  
    <span class="token function-variable function">state</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
    mutations<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  
    actions<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  
    getters<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  
<span class="token keyword">const</span> moduleB <span class="token operator">=</span> <span class="token punctuation">{</span>  
    <span class="token function-variable function">state</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
    mutations<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  
    actions<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  
    getters<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  
    modules<span class="token operator">:</span> <span class="token punctuation">{</span>  
        a<span class="token operator">:</span> moduleA<span class="token punctuation">,</span>  
        b<span class="token operator">:</span> moduleB  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  

store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>a   <span class="token comment">// moduleA的状态  </span>
store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>b   <span class="token comment">// moduleB的状态  </span>
</code></pre></div><p><strong>场景</strong></p> <ul><li>当 ajax 请求数据为组件公用时，可以将代码放在 action 中，不是共用则放在某一组件的 methods 中。</li> <li>注：vuex 中获取的数据，不能直接更改，需要浅拷贝对象后更改，否则报错。</li> <li>vuex 中的数据再页面刷新后数据会消失，因此可以使用 sessionStorage 或 localStorage 存储数据</li></ul> <p><strong>mapGetters</strong></p> <ul><li>用于组件中批量使用 vuex 中的 getter 属性</li> <li>在组件中引入 mapGetters，将其展开混入 computed 对象中</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> mapGetters <span class="token punctuation">}</span> form <span class="token string">'vuex'</span>  
<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>  
    computed<span class="token operator">:</span><span class="token punctuation">{</span>  
        <span class="token operator">...</span><span class="token function">mpaGetters</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'total'</span><span class="token punctuation">,</span> <span class="token string">'count'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  
</code></pre></div><p><strong>mapMutations</strong></p> <ul><li>在组件中重复使用 mutation</li> <li>使用 mapMutations 辅助函数</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> mapMutations <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vuex'</span>  
methods<span class="token operator">:</span><span class="token punctuation">{</span>  
    <span class="token operator">...</span><span class="token function">mapMutations</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  
        setNumber<span class="token operator">:</span> <span class="token string">'SET_NUMBER'</span>  
    <span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span>  
</code></pre></div><p>其中，SET_NUMBER 为 mutations 中方法，调用 this.$store.commit('SET_NUMBER', 10) 就可以使用 this.setNumber(10) 代替。</p> <p><strong>mutations 和 actions 区别</strong></p> <ul><li>action 提交的是 mutation，而不是直接变更状态，可以使用异步</li> <li>mutation 直接变更状态，只能使用同步</li> <li>提交方式不同</li> <li>接收参数不同，mutation 第一个参数是 state，action 第一个参数为 context（上下文）</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// actions提交  </span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">diaptch</span><span class="token punctuation">(</span><span class="token string">'ACTION_NAME'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>  

<span class="token comment">// mutations提交  </span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'SET_NUMBER'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>  

<span class="token comment">// context包含内容：  </span>
<span class="token punctuation">{</span>  
    state<span class="token punctuation">,</span>   <span class="token comment">// 等同于store.state，若在模块中则为局部状态  </span>
    commit<span class="token punctuation">,</span>  
    dispatch<span class="token punctuation">,</span>  
    getters  
    rootState<span class="token punctuation">,</span>  
    rootGetters  
<span class="token punctuation">}</span>  
</code></pre></div><p><strong>v-model 中使用 vuex 中 state 的值</strong></p> <ul><li>必须通过计算属性来转换，计算属性中要有 getter 和 setter</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>input v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;message&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>  

computed<span class="token operator">:</span><span class="token punctuation">{</span>  
    message<span class="token operator">:</span><span class="token punctuation">{</span>  
        <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>message  
        <span class="token punctuation">}</span><span class="token punctuation">,</span>  
        <span class="token function">set</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">{</span>  
            <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'updateMessage'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>  
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  
</code></pre></div><h3 id="vue-router"><a href="#vue-router" class="header-anchor">#</a> Vue-router</h3> <ul><li>路由模式（hash，H5 history）</li> <li>路由配置（动态路由、懒加载）</li></ul> <p><strong>基本使用</strong></p> <ol><li>安装后在 main.js 中引入 VueRouter 组件</li> <li>定义路由数组，每一项包含 path 路径、组件导入</li> <li>实例化 VueRouter 对象，也可以直接在实例化对象中添加路由数组</li> <li>根实例中挂载路由</li> <li>在 App.vue 中使用路由<code>&lt;router-view&gt;&lt;/router-view&gt;</code></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  
    mode<span class="token operator">:</span> <span class="token string">'history'</span><span class="token punctuation">,</span>  <span class="token comment">// 默认为hash  </span>
    routes<span class="token operator">:</span><span class="token punctuation">[</span>  
        <span class="token operator">...</span>authentication<span class="token punctuation">,</span>  <span class="token comment">// 其他js文件中定义的路由数组  </span>
        <span class="token punctuation">{</span>  
            path<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>  
            name<span class="token operator">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span>  
            <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span>@<span class="token operator">/</span>Index<span class="token punctuation">.</span>vue<span class="token punctuation">)</span>  <span class="token comment">// 懒加载  </span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>  
        <span class="token punctuation">{</span>  
            path<span class="token operator">:</span> <span class="token string">&quot;/productintro&quot;</span><span class="token punctuation">,</span>  
            name<span class="token operator">:</span> <span class="token string">&quot;productintro&quot;</span><span class="token punctuation">,</span>  
            <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>  
                <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: &quot;system&quot; */</span> <span class="token string">&quot;@/views/home/product/Index.vue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
            <span class="token comment">// 还可以添加子路由，子路由默认链接在父路由path后面  </span>
            <span class="token comment">// 如此处后path一定链接在/prodectintro后  </span>
            children<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span>productintro<span class="token punctuation">]</span>  
        <span class="token punctuation">}</span><span class="token punctuation">,</span>  
    <span class="token punctuation">]</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  
</code></pre></div><p><strong>动态路由</strong></p> <ul><li>在 router 目录下的 index.js 文件中，对 path 属性加上<code>/:id</code>。使用 router 对象的 params.id 获取动态参数</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> User <span class="token operator">=</span> <span class="token punctuation">{</span>  
    <span class="token comment">// 获取参数如 10 20  </span>
    template<span class="token operator">:</span> <span class="token string">'&lt;div&gt;User {{ $route.params.id }}&lt;/div&gt;'</span>  
<span class="token punctuation">}</span>  

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  
    routes<span class="token operator">:</span><span class="token punctuation">[</span>  
        <span class="token comment">// 动态路径参数，以冒号开头。  </span>
        <span class="token punctuation">{</span>path<span class="token operator">:</span> <span class="token string">'/user/:id'</span><span class="token punctuation">,</span> component<span class="token operator">:</span> User<span class="token punctuation">}</span>  
    <span class="token punctuation">]</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  
</code></pre></div><p><strong>路由跳转</strong></p> <ol><li>name跳转页面
<code>this.$router.push({ name: 'anotherPage', params: {id: 1} } )</code><br>
另一页面接收该参数的方式：
<code>this.$route.params.id</code></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>params<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li><p>path跳转页面
<code>this.$router.push({ path: '/anotherPage', query: {id:1} } );</code><br>
另一页面接收该参数的方式：
<code>this.$route.query.id</code></p></li> <li><p>参数接收区别：</p></li></ol> <ul><li>path 的 query 传参会显示在 url 后边的地址栏中（/anotherPage?id=1），可以直接获取，name 的 params 传递参数不会展示到地址栏</li> <li>由于动态路由也是使用 params 传递，所以 push 中 path 和 params 不能一起使用，否则 params 无效，需要使用 name 来指定页面</li></ul> <p><strong>路由懒加载</strong></p> <ul><li>和异步加载组件相同，在 routes 中设置<code>component: () =&gt; import(组件路径)</code></li></ul> <p><strong>说明</strong><br>
像 this.$refs.form<br>
this.$routes<br>
this.$store<br>
就是挂载在 this 上的 vue <strong>内部属性</strong>，$ 属于一个标记，无特殊含义，与用户自己定义的属性区分开来</p> <p><strong>vue-router 导航钩子</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 在跳转前进行权限判断，属于全局导航钩子  </span>
router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  

<span class="token punctuation">}</span>  
</code></pre></div><p><strong>vue <code>$router</code>和<code>$route</code>的区别</strong></p> <ul><li>router 为 VueRouter 的实例，相当于一个全局的路由对象，里面有很多属性和子对象，例如 history 对象</li> <li>route 相当于正在跳转的路由对象，从里面可以获取 name，path，param 等</li></ul> <p><strong>路由传参三种方式</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 完整的path  </span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/user/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>userId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span>  

<span class="token comment">// params传递  </span>
router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span><span class="token string">'user'</span><span class="token punctuation">,</span> params<span class="token operator">:</span> <span class="token punctuation">{</span>userId<span class="token operator">:</span> <span class="token number">123</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  

<span class="token comment">// query传递，相当于/register?plan=private  </span>
router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>path<span class="token operator">:</span><span class="token string">'regester'</span><span class="token punctuation">,</span> query<span class="token operator">:</span><span class="token punctuation">{</span> plan<span class="token operator">:</span> <span class="token string">'private'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
</code></pre></div><p><strong>注意：路径中加不加<code>/</code>?</strong></p> <ul><li>以<code>/</code>开头的嵌套路径会被当作根路径，不会嵌套之前的路径</li> <li>不加<code>/</code>的路径会链接到之前的路径后面去</li></ul> <h3 id="axios-封装"><a href="#axios-封装" class="header-anchor">#</a> axios 封装</h3> <ul><li>请求之前：一般接口都有鉴权认证(token)，因此在接口的请求头中，需要加入 token。而如果每次请求再去添加，则会加大工作量且容易出错。所以，使用 axios 拦截器可以在请求的拦截器中添加 token</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 请求拦截器，请求发送前拦截  </span>
axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">conifg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  
    <span class="token comment">// ...可以添加其他处理  </span>
    config<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>x_access_token <span class="token operator">=</span> token  <span class="token comment">// 添加token  </span>
    <span class="token keyword">return</span> config  
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  
</code></pre></div><ul><li>响应之后：若响应失败，则在 axios 中统一处理，可以大大降低工作量，提高代码质量。这里使用 axios 的响应拦截器。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 响应拦截器  </span>
axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token comment">// 用户token失效  </span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token number">401</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        <span class="token comment">// 清空用户信息  </span>
        sessionStorage<span class="token punctuation">.</span>user <span class="token operator">=</span> <span class="token string">''</span>  
        sessionStorage<span class="token punctuation">.</span>token <span class="token operator">=</span> <span class="token string">''</span>  
        window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">'/'</span>  <span class="token comment">// 返回登录页  </span>
        <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>  <span class="token comment">// 返回promise错误状态  </span>
    <span class="token punctuation">}</span>  
    <span class="token comment">// 若接口请求失败  </span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>status <span class="token operator">!==</span> <span class="token number">200</span> <span class="token operator">||</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>code <span class="token operator">!==</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>  
        <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">if</span><span class="token punctuation">(</span>axios<span class="token punctuation">.</span><span class="token function">isCancel</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        requestList<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">0</span>  
        <span class="token comment">// store.dispatch('changeGlobalState', {loading: false})  </span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">axios<span class="token punctuation">.</span>Cancel</span><span class="token punctuation">(</span><span class="token string">'cancel request'</span><span class="token punctuation">)</span>  
    <span class="token punctuation">}</span>  
    <span class="token keyword">else</span><span class="token punctuation">{</span>  
        message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'网络请求失败，请重试'</span><span class="token punctuation">)</span>  
    <span class="token punctuation">}</span>  
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  
</code></pre></div><p><strong>axios 使用</strong></p> <ul><li>执行 get 请求</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>aixos<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>  
    params<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 接口参数  </span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 请求成功添加处理  </span>
<span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>  <span class="token comment">// 请求失败添加处理  </span>
<span class="token punctuation">}</span>  
</code></pre></div><ul><li>执行 post 请求</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>  
    data<span class="token operator">:</span> xxx  <span class="token comment">// 参数  </span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>  
    headers<span class="token operator">:</span> xxx<span class="token punctuation">,</span>  <span class="token comment">// 请求的头信息  </span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 请求成功添加处理  </span>
<span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>  <span class="token comment">// 请求失败添加处理  </span>
<span class="token punctuation">}</span>  
</code></pre></div><ul><li>axios API 通过相关配置传递给 axios 完成请求</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// delete  </span>
<span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  
    method<span class="token operator">:</span> <span class="token string">'delete'</span><span class="token punctuation">,</span>  
    url<span class="token operator">:</span> <span class="token string">'xxx'</span><span class="token punctuation">,</span>  
    cache<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  
    params<span class="token operator">:</span> <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token number">123</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  
    headers<span class="token operator">:</span> xxx<span class="token punctuation">,</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token comment">// post  </span>
<span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  
    method<span class="token operator">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>  
    url<span class="token operator">:</span> <span class="token string">'/user/123'</span><span class="token punctuation">,</span>  
    data<span class="token operator">:</span><span class="token punctuation">{</span>  
        firstName<span class="token operator">:</span> <span class="token string">'z'</span><span class="token punctuation">,</span>  
        lastName<span class="token operator">:</span> <span class="token string">'x'</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre></div><p><strong>基本使用封装</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*  
* url:请求的url  
*p arams:请求的参数  
* config:请求时的header信息  
* method:请求方法  
*/</span>  
<span class="token keyword">const</span> <span class="token function-variable function">request</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> url<span class="token punctuation">,</span> params<span class="token punctuation">,</span> config<span class="token punctuation">,</span> method <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
  <span class="token comment">// 如果是get请求，则将参数json化  </span>
  <span class="token keyword">let</span> newParams <span class="token operator">=</span> methods <span class="token operator">===</span> <span class="token string">'get'</span> <span class="token operator">?</span> <span class="token punctuation">{</span>params<span class="token punctuation">}</span> <span class="token operator">:</span> params  
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  
    axios<span class="token punctuation">[</span>method<span class="token punctuation">]</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> newParams<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  
      <span class="token function">resolve</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span>  
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">.</span>Cancel<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>  
        <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>  
      <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  
      <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>  
    <span class="token punctuation">}</span><span class="token punctuation">)</span>  
  <span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span>  
</code></pre></div><h2 id="vue-原理"><a href="#vue-原理" class="header-anchor">#</a> Vue 原理</h2> <h3 id="mvvm"><a href="#mvvm" class="header-anchor">#</a> MVVM</h3> <img alt="mvvm" src="/myBlog/assets/img/mvvm.451a56b5.png" style="zoom:80%;"> <ul><li>Model-View-ViewModel</li> <li>数据驱动视图，通过 ViewModel 连接 View 和 Model，进行数据绑定并监听 DOM 事件</li> <li>因此，数据改变，View 自动发生改变。View 中的 DOM 事件也可以被成功监听并修改 Model 数据。</li> <li>vue 自动实现 view 更新，不需要操作 DOM。</li></ul> <h3 id="vue-响应式"><a href="#vue-响应式" class="header-anchor">#</a> Vue 响应式</h3> <p>Vue 响应式：组件 data 数据一旦变化，则立刻触发视图更新<br> <strong>响应式过程</strong></p> <p><img src="/myBlog/assets/img/vuereactive.d859b69e.png" alt="vue-reactive"><br> <strong>总结：</strong></p> <ul><li>任何一个 vue 组件上都有一个 Watcher 实例。</li> <li>vue 中的 data 数据会被添加 getter 和 setter 属性。</li> <li>当组件的 render 函数执行时，data 中的 getter 方法会被调用，此时 vue 会记录此组件所依赖的所有 data（依赖收集）。</li> <li>data 变化时，setter 方法被调用，vue 会通知所有依赖于该数据的组件去调用他们的 render 函数进行更新。</li></ul> <p><strong>原理</strong></p> <ul><li>核心 API - Object.defineProperty</li> <li>使用 Observer 对数据进行劫持和深度监听，若传入的 data 是一个对象，则对 data 进行深度递归，添加 setter 和 getter</li> <li>getter 中 Dep 实例会调用 dep.append 方法收集依赖，把当前渲染的 Watcher 记住</li> <li>setter 中设置新值，Dep 会调用 dep.notify 方法通知之前记住的 Watcher 进行视图更新</li></ul> <p><strong>如何监听数组的变化？</strong></p> <ul><li>调用另一套机制 —— 重写 Array 原型方法</li> <li>首先拷贝数组的原型，然后在自己创建的原型对象中重写 7 个会改变数组本身的方法，如 push、pop、splice 等，在重写的方法中首先调用原 Array 方法改变数组，然后加入一个视图更新的逻辑，即可更新视图</li> <li>最后更改数据的原型链，执行方法时会执行自己重写的方法，里面添加了更新视图的逻辑</li></ul> <p><strong>实现</strong><br>
使用 Object.defineProperty 实现对象的深度监听，<br>
使用重写原型的方法实现数组监听：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 更新视图逻辑  </span>
<span class="token keyword">function</span> <span class="token function">updataView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'更新视图'</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span>  

<span class="token comment">// (1) 拷贝数组原型  </span>
<span class="token keyword">const</span> oldProto <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype  
<span class="token comment">// (2) 创建新对象，原型指向Array.prototyp，扩展新方法不影响原型  </span>
<span class="token keyword">const</span> arrProto <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>oldProto<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token comment">// (3) 重写会改变数组本身的方法  </span>
<span class="token punctuation">[</span><span class="token string">'push'</span><span class="token punctuation">,</span> <span class="token string">'pop'</span><span class="token punctuation">,</span> <span class="token string">'shift'</span><span class="token punctuation">,</span> <span class="token string">'unshift'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">method</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  
    arrProto<span class="token punctuation">[</span>method<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
       <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">method</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span>  
       
       <span class="token comment">// 重写的方法里面加上一个视图更新逻辑  </span>
       <span class="token function">updataView</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  

<span class="token comment">// 2. 给data中数据添加getter和setter  </span>
<span class="token keyword">function</span> <span class="token function">defineReactive</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token comment">// 3. 深度监听（适用数组）  </span>
    <span class="token function">Observer</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span>  

    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>  
        <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
            <span class="token keyword">return</span> value<span class="token punctuation">;</span>  
        <span class="token punctuation">}</span><span class="token punctuation">,</span>  
        <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
            <span class="token keyword">if</span><span class="token punctuation">(</span>newVal <span class="token operator">!=</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>  
                <span class="token comment">// 3. 深度监听  </span>
                <span class="token function">Observer</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span>  
                <span class="token comment">// 设置新值  </span>
                value <span class="token operator">=</span> newVal  

                <span class="token comment">// 更新视图  </span>
                <span class="token function">updateView</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
            <span class="token punctuation">}</span>  
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span><span class="token punctuation">)</span>  

<span class="token punctuation">}</span>  

<span class="token comment">// 1. 数据劫持，将属性变为响应式  </span>
<span class="token keyword">function</span> <span class="token function">Observer</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">'object'</span> <span class="token operator">||</span> target <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>  
        <span class="token comment">// 不是对象或数组  </span>
        <span class="token keyword">return</span> target  

    <span class="token comment">// (4) 监听数组  </span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        target<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> arrProto  
    <span class="token punctuation">}</span>  
    
    <span class="token comment">// 遍历属性，添加getter和setter  </span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> target<span class="token punctuation">)</span><span class="token punctuation">{</span>  
        <span class="token function">defineReactive</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  

<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>  
    name<span class="token operator">:</span> <span class="token string">'z'</span><span class="token punctuation">,</span>  
    age<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>  
    info<span class="token operator">:</span> <span class="token punctuation">{</span>  
        address<span class="token operator">:</span> <span class="token string">'Shanghai'</span>  <span class="token comment">// 需要深度监听  </span>
    <span class="token punctuation">}</span>  
    nums<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span>  <span class="token comment">// 数组  </span>
<span class="token punctuation">}</span>  
<span class="token function">Observer</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>  

data<span class="token punctuation">.</span>info<span class="token punctuation">.</span>address <span class="token operator">=</span> <span class="token string">'Shenzhen'</span>  <span class="token comment">// set中也需要深度监听，才能正确赋值  </span>
data<span class="token punctuation">.</span>nums<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>  <span class="token comment">// 监听数组  </span>
data<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token string">'100'</span>  <span class="token comment">// 新增属性，无法监听，需要使用Vue.set  </span>
<span class="token keyword">delete</span> data<span class="token punctuation">.</span>name  <span class="token comment">// 删除属性，无法监听，Vue.delete(data.name)  </span>
</code></pre></div><p><strong>Object.defineProperty 缺点</strong></p> <ul><li>深度监听需要递归到底，一次性计算量大</li> <li>无法监听新增/删除属性（Vue 中用 Vue.set 和 Vue.delete 实现正确监听）</li> <li>无法原生监听数组，需要特殊处理</li></ul> <h3 id="虚拟-dom-和-diff-算法"><a href="#虚拟-dom-和-diff-算法" class="header-anchor">#</a> 虚拟 DOM 和 diff 算法</h3> <ul><li>v-dom 是实现 vue 和 React 的重要基石</li> <li>diff 算法是 v-dom 中的核心</li> <li>由于 DOM 操作非常耗时，使用数据驱动视图，有效控制 DOM 操作</li></ul> <p><strong>解决方案：</strong></p> <ul><li>将 DOM 的一些操作转换为 JS 计算，因为 JS 执行速度较快</li> <li>v-dom：使用 JS 对象模拟 DOM 结构</li> <li>diff 算法：通过 JS 计算出最小的变更，再操作 DOM</li></ul> <p><strong>v-dom：</strong></p> <ul><li>用 JS 模拟 DOM 结构（vnode)，然后构建一个真正的 DOM 树插到文档中</li> <li>状态变更后，重新构造一颗新的对象树，然后和旧的 vnode 比较，记录差异</li> <li>只把差异部分应用到第一步中真正的 DOM 树上，视图更新</li> <li>算法实现：根据 DOM 结构 createElement，然后使用 setAttribute 添加属性，appendChild 添加子节点等</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 用JS模拟DOM结构   --&gt;</span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>div1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>v-dom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">font-size</span><span class="token punctuation">:</span> 20px</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>a<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// vNode  </span>
<span class="token punctuation">{</span>  
    tag<span class="token operator">:</span> <span class="token string">'div'</span><span class="token punctuation">,</span>  
    props<span class="token operator">:</span> <span class="token punctuation">{</span>  
        id<span class="token operator">:</span> <span class="token string">'div1'</span><span class="token punctuation">,</span>  
        className<span class="token operator">:</span> <span class="token string">'container'</span>  
    <span class="token punctuation">}</span><span class="token punctuation">,</span>  
    children<span class="token operator">:</span><span class="token punctuation">[</span>  
        <span class="token punctuation">{</span>  
            tag<span class="token operator">:</span> <span class="token string">'p'</span><span class="token punctuation">,</span>  
            children<span class="token operator">:</span> <span class="token string">'v-dom'</span>  
        <span class="token punctuation">}</span><span class="token punctuation">,</span>  
        <span class="token punctuation">{</span>  
            tag<span class="token operator">:</span> <span class="token string">'ul'</span><span class="token punctuation">,</span>  
            props<span class="token operator">:</span><span class="token punctuation">{</span>  
                style<span class="token operator">:</span> <span class="token string">'font-size: 20px'</span>  
            <span class="token punctuation">}</span>  
            children<span class="token operator">:</span><span class="token punctuation">[</span>  
                <span class="token punctuation">{</span>  
                    tag<span class="token operator">:</span> <span class="token string">'li'</span><span class="token punctuation">,</span>  
                    children<span class="token operator">:</span> <span class="token string">'a'</span>  
                <span class="token punctuation">}</span>  
                
            <span class="token punctuation">]</span>  
        <span class="token punctuation">}</span>  
    <span class="token punctuation">]</span>  
<span class="token punctuation">}</span>  
</code></pre></div><p><strong>diff 算法</strong></p> <ul><li>逐层对比，只比较同一层级，不跨级比较</li> <li>tag（标签名）不相同，则直接删掉重建，不再深度比较</li> <li>tag 和 key，两者都相同，则认为是相同节点，不再深度比较</li> <li>因此，时间复杂度被优化到O(n)</li></ul> <p><img src="/myBlog/assets/img/diff.47d501d7.png" alt="diff"> <strong>过程：</strong></p> <ul><li>调用 patch 函数，接收新旧虚拟节点为参数进行比较，然后局部更新真实 DOM</li> <li>patch 函数中首先判断两个节点是否值得比较（sameVnode），若值得比较则执行 patchVnode</li> <li>若两者都有子节点，则执行 updateChildren 比较子节点</li></ul> <p><strong>函数说明：</strong><br>
patch：</p> <ul><li>新旧 vnode 比较，若不值得比较，则移除旧节点，创建新节点插入，最终返回一个 vnode</li></ul> <p>sameVnode：</p> <ul><li>比较 tag 和 key 值</li> <li>判断是否为注释节点或者 type 信息等等</li> <li>若不值得比较则直接用 vnode 替换 oldVnode</li></ul> <p>patchVnode：</p> <ul><li>找到真实 DOM，判断新旧 vnode 是否指向同一个对象，是的话直接 return</li> <li>若都有文本节点且不相等，则替换为新 vnode 的文本节点</li> <li>若只有一个有子节点，则根据情况删除或者添加子节点</li> <li>若都有子节点，则执行 updateChildren 函数比较子节点</li></ul> <p>updateChildren：</p> <ul><li>将新旧 vnode 的子节点提取出来，如 Vch 和 oldCh</li> <li>子节点都有两个头尾变量 startIdx 和 endIdx，相互比较，共 4 种比较方式，分情况处理</li> <li>子节点 sameVnode 成功后会接着执行 patchVnode，然后层层递归下去，直到对比完成</li></ul> <p><strong>为什么 v-for 中需要 key？</strong></p> <ul><li>不使用 key 则更新时需要将旧节点全部删除，再插入新节点</li> <li>使用 key 可以将相同的节点保留，移动位置，只需要创建不同的节点插入</li> <li>更加快速高效</li></ul> <h3 id="模板编译"><a href="#模板编译" class="header-anchor">#</a> 模板编译</h3> <ul><li>模板编译为 render 函数，执行 render 函数返回vnode</li> <li>基于 vnode 再执行 patch 函数</li> <li>使用 webpack vue-loader，会在开发环境下编译模板</li></ul> <p><strong>组件的渲染/更新过程</strong><br>
一个组件渲染到页面，修改 data 触发视图更新</p> <ul><li>响应式：监听 data 属性 getter 和 setter</li> <li>编译模板：模板到 render 函数再到 vnode</li> <li>v-dom：patch(ele, vnode)（第一次）, patch(vnode, newVnode)（更新）</li></ul> <p><strong>初次渲染过程：</strong></p> <ul><li>解析模板为 render 函数（或在开发环境已完成，vue-loader）</li> <li>触发响应式，监听 data 属性 getter setter</li> <li>执行 render 函数，生成 vnode，patch(elem, vnode)</li></ul> <p><strong>更新过程：</strong></p> <ul><li>修改 data，触发 setter（此前在 getter 中已监听）</li> <li>重新执行 render 函数，生成 newVnode</li> <li>patch(vnode, newVnode)</li></ul> <p><strong>异步渲染：</strong></p> <ul><li>$nextTick</li> <li>汇总 data 的修改，一次性更新视图</li> <li>减少 DOM 操作次数，提高性能</li></ul> <h3 id="前端路由原理"><a href="#前端路由原理" class="header-anchor">#</a> 前端路由原理</h3> <ul><li>前端路由本质就是监听 URL 的变化，然后匹配路由规则，显示相应的页面，并且无需刷新</li> <li>hash 路由：通过 onhashchange 事件监听 url 中 hash 的变化，若刷新则不会触发，可以使用 load 事件，若跳转则触发 hashchange 事件</li> <li>H5 history路由：监听 url 中的路径变化，需要客户端和服务端的共同支持，更加美观</li> <li>前端路由跳转不刷新页面，后端路由一定会刷新页面</li></ul> <p><strong>1. hash 路由</strong></p> <ul><li>如 http://localhost/hash.html#/home，存在一个#符号，vue 默认 hash 模式</li> <li>页面中的 hash 发生变化时，会触发 hashchange 事件，网页跳转，但不刷新页面</li> <li>使用 location.hash 可以获取 hash 值</li> <li>hash 不会提交到服务端</li></ul> <p><strong>2. history 路由</strong></p> <ul><li>如 http://localhost/home</li> <li>跳转时也不刷新页面，需要后端配合，后端统一返回一个 index.html 页面</li> <li>所以前端路由需要覆盖所有的路由情况，并默认返回一个 404 页面</li> <li>history.pushState(obj, title, url)：前进到指定 url，不刷新页面</li> <li>window.onpopstate()：浏览器前进或后退时触发</li></ul> <p><strong>选择</strong></p> <ul><li>to B 的系统推荐用 hash，简单易用，对 url 规范不敏感</li> <li>to C 的系统，可以考虑选择 H5 history，但需要服务端支持</li></ul> <h3 id="vue-class-类组件"><a href="#vue-class-类组件" class="header-anchor">#</a> Vue class（类组件）</h3> <ul><li>初始化的 data 可以被声明为类属性</li> <li>methods 可以直接被声明为类的成员方法</li></ul> <p><strong>vue-property-decorator</strong></p> <ul><li>@Component 装饰器可以使类成为 Vue 组件</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> Componnet <span class="token keyword">from</span> <span class="token string">'vue-class-component'</span>    <span class="token comment">// 推荐vue-property-decorator</span>

<span class="token comment">// App class will be a Vue component</span>
@Component
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p><strong>基本使用</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 使用js的vue组件</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> props<span class="token punctuation">,</span> methods<span class="token punctuation">,</span> created<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>

<span class="token comment">// 使用TS的vue组件</span>
<span class="token operator">&lt;</span>script lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">XXX</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> string <span class="token operator">=</span> <span class="token string">'z'</span><span class="token punctuation">;</span>      <span class="token comment">// 直接声明data变量</span>
    <span class="token function">printName</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token operator">:</span> string</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span>   <span class="token comment">// 直接写methods方法</span>
    @<span class="token function">Prop</span><span class="token punctuation">(</span>Number<span class="token punctuation">)</span> num<span class="token operator">:</span> number <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>   <span class="token comment">// @Prop表示不是data，而是prop，运行时是个Number类型</span>

<span class="token punctuation">}</span>
</code></pre></div><h2 id="vue3"><a href="#vue3" class="header-anchor">#</a> Vue3</h2> <ul><li>全部使用 TS 重写（响应式、v-dom、模板编译等）</li> <li>性能升级，代码量减少</li> <li>部分 API 调整</li></ul> <h3 id="proxy"><a href="#proxy" class="header-anchor">#</a> Proxy</h3> <p><strong>基本使用</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>  
    name<span class="token operator">:</span> <span class="token string">'z'</span><span class="token punctuation">,</span>  
    age<span class="token operator">:</span> <span class="token number">25</span>  
<span class="token punctuation">}</span>  
<span class="token comment">// const data = ['a', 'b', 'c']  </span>

<span class="token keyword">const</span> proxyData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">{</span>  
    <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span><span class="token punctuation">{</span>  
        <span class="token comment">// 只处理本身（非原型）属性  </span>
        <span class="token keyword">const</span> ownKeys <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">OwnKeys</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>  
        <span class="token keyword">if</span><span class="token punctuation">(</span>ownKeys<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span>  <span class="token comment">// 监听  </span>
        <span class="token punctuation">}</span>  

        <span class="token keyword">const</span> result <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>  
        <span class="token keyword">return</span> result  <span class="token comment">// 返回结果  </span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>  
    <span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span><span class="token punctuation">{</span>  
        <span class="token comment">// 重复的数据，不处理  </span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>val <span class="token operator">===</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  

        <span class="token keyword">const</span> result <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>  
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'set'</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> val<span class="token punctuation">)</span>  
        <span class="token keyword">return</span> result  <span class="token comment">// 是否设置成功，布尔值  </span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>  
    <span class="token function">deleteProperty</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        <span class="token keyword">const</span> result <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">deleteProperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span>  
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'deleteProperty'</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span>  
        <span class="token keyword">return</span> result   <span class="token comment">// 是否删除成功，布尔值  </span>
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  

<span class="token comment">//使用  </span>
proxyData<span class="token punctuation">.</span>address <span class="token operator">=</span> <span class="token string">&quot;address&quot;</span>  
<span class="token keyword">delete</span> proxyData<span class="token punctuation">.</span>address  
</code></pre></div><p><strong>Reflect 作用</strong></p> <ul><li>和 Proxy 能力一一对应</li> <li>规范化、标准化，如 Reflect.deleteProperty(obj, 'a')</li> <li>替代 Object 的一些函数方法，如 Reflect.ownKeys(obj)，获取 obj 的 key</li></ul> <p><strong>Proxy 实现响应式</strong><br>
以上代码基础上加上深度监听，并加上一个判断得出是否是新增属性</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 创建响应式  </span>
<span class="token keyword">function</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token parameter">target <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> target <span class="token operator">!==</span> <span class="token string">'object'</span> <span class="token operator">||</span> target <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token comment">// 不是对象或数组，则返回  </span>
        <span class="token keyword">return</span> target  
    <span class="token punctuation">}</span>  

    <span class="token comment">// 代理配置  </span>
    <span class="token keyword">const</span> proxyConf <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
            <span class="token comment">// 只处理本身（非原型的）属性  </span>
            <span class="token keyword">const</span> ownKeys <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">ownKeys</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>  
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ownKeys<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token comment">// 监听  </span>
            <span class="token punctuation">}</span>  
    
            <span class="token keyword">const</span> result <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>  
        
            <span class="token comment">// 深度监听  </span>
            <span class="token comment">// 性能如何提升的？  </span>
            <span class="token keyword">return</span> <span class="token function">reactive</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>  
        <span class="token punctuation">}</span><span class="token punctuation">,</span>  
        <span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
            <span class="token comment">// 重复的数据，不处理  </span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">===</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
                <span class="token keyword">return</span> <span class="token boolean">true</span>  
            <span class="token punctuation">}</span>  
    
            <span class="token keyword">const</span> ownKeys <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">ownKeys</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>  
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ownKeys<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'已有的 key'</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span>  
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>  
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'新增的 key'</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span>  
            <span class="token punctuation">}</span>  

            <span class="token keyword">const</span> result <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>  
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'set'</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> val<span class="token punctuation">)</span>  
            <span class="token comment">// console.log('result', result) // true  </span>
            <span class="token keyword">return</span> result <span class="token comment">// 是否设置成功  </span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>  
        <span class="token function">deleteProperty</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
            <span class="token keyword">const</span> result <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">deleteProperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span>  
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'delete property'</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span>  
            <span class="token comment">// console.log('result', result) // true  </span>
            <span class="token keyword">return</span> result <span class="token comment">// 是否删除成功  </span>
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>  

    <span class="token comment">// 生成代理对象  </span>
    <span class="token keyword">const</span> observed <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> proxyConf<span class="token punctuation">)</span>  
    <span class="token keyword">return</span> observed  
<span class="token punctuation">}</span>  

<span class="token comment">// 测试数据  </span>
<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>  
    name<span class="token operator">:</span> <span class="token string">'zhangsan'</span><span class="token punctuation">,</span>  
    age<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>  
    info<span class="token operator">:</span> <span class="token punctuation">{</span>  
        city<span class="token operator">:</span> <span class="token string">'beijing'</span><span class="token punctuation">,</span>  
        a<span class="token operator">:</span> <span class="token punctuation">{</span>  
            b<span class="token operator">:</span> <span class="token punctuation">{</span>  
                c<span class="token operator">:</span> <span class="token punctuation">{</span>  
                    d<span class="token operator">:</span> <span class="token punctuation">{</span>  
                        e<span class="token operator">:</span> <span class="token number">100</span>  
                    <span class="token punctuation">}</span>  
                <span class="token punctuation">}</span>  
            <span class="token punctuation">}</span>  
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  

<span class="token keyword">const</span> proxyData <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>  
</code></pre></div><p><strong>优点：</strong></p> <ul><li>深度监听，性能更好，因为一开始并不递归，而是什么时候访问到什么时候再递归</li> <li>可监听新增和删除属性</li> <li>可监听数组变化</li></ul> <h2 id="vue-ts"><a href="#vue-ts" class="header-anchor">#</a> Vue + TS</h2> <h3 id="基于类的组件"><a href="#基于类的组件" class="header-anchor">#</a> 基于类的组件</h3> <ul><li>为了使用 ts，先设置<code>&lt;script&gt;</code>标签的 lang 属性为 ts</li> <li>vue-property-decorator 使用了 Vue 的类组件包，包含了各种装饰器，默认使用类名作为 name</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// vue component-ts</span>
<span class="token operator">&lt;</span>script lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> Vue <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-property-decorator'</span>
<span class="token keyword">import</span> project <span class="token keyword">from</span> <span class="token string">'@/components/Project.vue'</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    components<span class="token operator">:</span> <span class="token punctuation">{</span>
        project
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">HelloWorld</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h3 id="vue-属性和方法"><a href="#vue-属性和方法" class="header-anchor">#</a> Vue 属性和方法</h3> <p><strong>data 属性</strong>
直接声明为变量即可</p> <div class="language-js extra-class"><pre class="language-js"><code>@Component
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">HelloWorld</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
    msg <span class="token operator">=</span> <span class="token string">&quot;hi&quot;</span><span class="token punctuation">;</span>
    list <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'z'</span><span class="token punctuation">,</span>
            age<span class="token operator">:</span> <span class="token string">'26'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>props 属性</strong>
使用<code>@Prop</code>装饰器在 Vue 组件中使用 props。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> Prop<span class="token punctuation">,</span> Vue <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-property-decorator'</span>
@Component
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">HelloWord</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
    @<span class="token function">Prop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> readonly msg<span class="token operator">!</span><span class="token operator">:</span> string<span class="token punctuation">;</span>   <span class="token comment">// readonly表示不能改变</span>
    @<span class="token function">Prop</span><span class="token punctuation">(</span><span class="token punctuation">{</span> required<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">'z'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> readolny name<span class="token operator">:</span> string<span class="token punctuation">;</span>  <span class="token comment">// required和default</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Computed 属性</strong>
以 get 关键字作为前缀</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">HelloWorld</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
    <span class="token keyword">get</span> <span class="token function">fullName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>firstName <span class="token operator">+</span> <span class="token string">''</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lastName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Methods</strong>
和 data 属性一样，直接在类中写方法即为 methods</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">HelloWorld</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
    <span class="token function">addNum</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token operator">:</span> number<span class="token punctuation">,</span> num2<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Watcher 监听</strong>
使用<code>@Watch</code>装饰器并传递需要监视的变量的名称</p> <div class="language-js extra-class"><pre class="language-js"><code>@<span class="token function">Watch</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span>
<span class="token function">nameChanged</span><span class="token punctuation">(</span><span class="token parameter">newVal<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> newVal<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 使用immediate和deep</span>
@<span class="token function">Watch</span><span class="token punctuation">(</span><span class="token string">'project'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    immediate<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> deep<span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">projectChanged</span><span class="token punctuation">(</span><span class="token parameter">newVal<span class="token operator">:</span> Person<span class="token punctuation">,</span> oldVal<span class="token operator">:</span> Person</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// do something</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Emit</strong>
从子组件 emit 一个方法到父组件，使用<code>@Emit</code>装饰器</p> <div class="language-js extra-class"><pre class="language-js"><code>@<span class="token function">Emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">addToCount</span><span class="token punctuation">(</span><span class="token parameter">n<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 注：使用时函数名会被转换为短横线分割（add-to-count)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>count <span class="token operator">+=</span> <span class="token constant">N</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
@<span class="token function">Emit</span><span class="token punctuation">(</span><span class="token string">'resetData'</span><span class="token punctuation">)</span>  <span class="token comment">// resetData为显式名称</span>
<span class="token function">resetCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span>some<span class="token operator">-</span>component reset<span class="token operator">-</span>data<span class="token operator">=</span><span class="token string">&quot;someMethod&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre></div><p><strong>生命周期</strong>
被声明为普通类方法，直接使用即可</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">HelloWorld</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
    <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 1</span>
    <span class="token punctuation">}</span>
    <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 2</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Mixins</strong>
首先创建一个 mixin 文件，包含我们与其他组件共享的数据
如创建一个 ProjectMixin.ts 的文件，其中共享了 projectName 和更新 ProjectName 的方法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> Vue <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-property-decorator'</span>
@Component
<span class="token keyword">class</span> <span class="token class-name">ProjectMixin</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
    projectName <span class="token operator">=</span> <span class="token string">&quot;my project&quot;</span>
    <span class="token function">setProjectName</span><span class="token punctuation">(</span><span class="token parameter">newVal<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>projectName <span class="token operator">=</span> newVal<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> ProjectMixin
</code></pre></div><p>引入 mixin 文件：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Project.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;project-detail&quot;</span><span class="token operator">&gt;</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span> projectDetail <span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> Vue<span class="token punctuation">,</span> Mixins <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-property-decorator'</span>
<span class="token keyword">import</span> ProjectMixin <span class="token keyword">from</span> <span class="token string">'@/mixins/ProjectMixin'</span>
@Component
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">project</span> <span class="token keyword">extends</span> <span class="token class-name">Mixins</span><span class="token punctuation">(</span>ProjectMixin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">get</span> <span class="token function">projectDetail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>projName <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token string">'Preetish HS'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h3 id="vuex-2"><a href="#vuex-2" class="header-anchor">#</a> Vuex</h3> <p>首先，需要安装两个流行的第三方库：</p> <div class="language-js extra-class"><pre class="language-js"><code>npm install vuex<span class="token operator">-</span>module<span class="token operator">-</span>decorators <span class="token operator">-</span><span class="token constant">D</span>
npm install vuex<span class="token operator">-</span><span class="token keyword">class</span> <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><ol><li><p>v-if和v-show的区别是什么？</p> <ul><li>v-if是Vue控制的真正的的渲染和销毁，v-show是css切换控制的</li> <li>v-if具有较大的切换开销，v-show具有较大的初始渲染开销</li> <li>若频繁切换则用v-show，若条件一般不变则用v-if</li></ul></li> <li><p><code>$route</code>和<code>$router</code>的区别是什么？</p></li> <li><p>Vue中几种常用的指令</p></li> <li><p>Vue中常用的修饰符</p></li> <li><p>v-on跨域绑定多个方法吗</p></li> <li><p>Vue中key值的作用</p> <ul><li>必须用key，且不能是index和random</li> <li>diff算法中通过tag和key来判断，是否是sameNode</li> <li>减少渲染次数，提升渲染性能</li></ul></li> <li><p>Vue的计算属性</p> <ul><li>缓存，data不变不会重新计算</li> <li>提高性能</li></ul></li> <li><p>如何定义vue-router的动态路由，获取传过来的值</p></li> <li><p>watch和computed的差异</p></li> <li><p>组件中的data为什么是函数？</p> <ul><li>Vue组件是一个类，每个地方使用这个组件时相当于是类的实例化</li> <li>为了防止数据共享，使用函数的话执行函数数据就会在闭包之中，修改数据后不会互相影响</li></ul></li> <li><p>组件渲染和更新的过程</p> <ul><li>vue响应式</li> <li>模板编译</li> <li>事件监听</li></ul></li> <li><p>对于MVVM的理解</p></li> <li><p>第一次页面加载会触发哪几个钩子</p></li> <li><p>DOM渲染在哪个生命周期中完成</p></li> <li><p>Vue组件生命周期（父子组件）</p></li> <li><p>Vue实现数据双向绑定的原理</p> <ul><li>input元素value = this.name</li> <li>绑定input事件this.name = $event.target.value</li> <li>data更新触发re-render</li></ul></li> <li><p>Vue组件间的通讯</p> <ul><li>父子组件props和this.$emit</li> <li>自定义事件event.$on, enent.$off, event.$emit</li> <li>vuex</li></ul></li> <li><p>Vuex是什么？怎么使用？使用场景？</p></li> <li><p>虚拟DOM的优缺点</p></li> <li><p>Vue和React的区别</p></li> <li><p>Vuex中mutation和action的详细区别</p></li> <li><p>Vue的diff算法</p> <ul><li>patch(elem, vnode)和patch(vnode, newVnode)</li> <li>patchVnode和addVnodes和removeVnodes</li> <li>updateChildren（key的重要性）</li></ul></li> <li><p>ajax请求应该放在哪个生命周期</p> <ul><li>mounted</li> <li>js是单线程，ajax异步获取数据</li> <li>组件渲染完成之后获取数据，放在mounted之前也没什么用</li></ul></li> <li><p>何时使用beforeDestroy</p> <ul><li>解绑自定义事件event.$off，防止内存泄漏</li> <li>清除定时器</li> <li>解绑自定义的DOM事件，如window.scrool</li></ul></li> <li><p>Vuex中action和mutation区别</p> <ul><li>action中处理异步，mutation不可用</li> <li>mutation中做原子操作</li> <li>action可以整合多个mutation</li></ul></li> <li><p>Vue性能优化</p> <ul><li>computed、v-if、v-show</li> <li>v-for使用key</li> <li>自定义事件、DOM事件及时销毁</li> <li>合理使用异步组件</li> <li>合理使用keep-alive</li> <li>data层级不要太深</li></ul></li> <li><p>异步渲染和$nextTick</p> <ul><li>异步渲染（合并data修改），提高渲染性能</li> <li>$nextTick在DOM更新完成之后触发回调</li></ul></li></ol></div> <footer class="page-edit" style="display:none;"><!----> <!----></footer> <!----> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/myBlog/assets/js/app.940a19a6.js" defer></script><script src="/myBlog/assets/js/3.92f17e55.js" defer></script><script src="/myBlog/assets/js/1.fb090512.js" defer></script><script src="/myBlog/assets/js/10.3cd559f0.js" defer></script>
  </body>
</html>
